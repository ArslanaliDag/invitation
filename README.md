# Генерация электронных пригласительных

Список имен приглашенных подставляется в уже заготовленный шаблон пригласительного. Для выполнения этой задачи можно использовать библиотеки:

- **Pillow (PIL)** для работы с изображениями.
- **Pandas** для удобной работы с текстовыми файлами.

## 1. Изменение размеров изображения в пикселях

Чтобы правильно разместить текст на изображении с известными размерами в миллиметрах и разрешением, нужно перевести размеры в пиксели:

- 209.97 мм × 300 пикселей/дюйм ≈ 2480 пикселей.
- 260.01 мм × 300 пикселей/дюйм ≈ 3071 пиксель.

## 2. Исправление проблемы с русскими символами

Для корректного отображения русских символов важно использовать правильный шрифт. По умолчанию, `ImageFont.load_default()` не поддерживает кириллицу. Вместо этого нужно загрузить системный шрифт, например, **Book Antiqua**, который поддерживает кириллицу.

## 3. Изменение размера текста

Для изменения размера текста можно использовать метод `truetype()` и передать нужный размер шрифта:

```python
    font = ImageFont.truetype("path_to_font/Book Antiqua.ttf", 80)
```

## 4. Изменение цвета текста

Цвет текста можно изменить, задав его в формате RGB. Например, для красного цвета:

```python
    draw.text((x, y), "Текст", font=font, fill=(255, 0, 0))
```

## 5. Замена шрифта на Book Antiqua

Для загрузки системного шрифта Book Antiqua, нужно указать путь к файлу шрифта:

python
font = ImageFont.truetype("path_to_font/Book Antiqua.ttf", size)

## 6. Центрирование текста

Чтобы отцентрировать текст по горизонтали в зависимости от длины ФИО, нужно динамически рассчитывать ширину текста и корректировать позицию его отображения. Для этого библиотека Pillow предоставляет метод textbbox() у объекта ImageDraw, который возвращает размер текста в пикселях. Пример:

python
bbox = draw.textbbox((x, y), "ФИО", font=font)
text_width = bbox[2] - bbox[0]
position_x = (image_width - text_width) // 2

## 7. Исправление ошибки AttributeError

Если появляется ошибка:

csharp
AttributeError: 'ImageDraw' object has no attribute 'textsize'.

В новых версиях библиотеки Pillow метод textsize() был заменён на метод textbbox(). Обновите код для использования этого метода для расчёта размеров текста с большей точностью.
